charon {

    <%- if @filelog -%>
    # Section to define file loggers, see LOGGER CONFIGURATION in
    # strongswan.conf(5).
    filelog {

        # <filename> is the full path to the log file.
        # <filename> {

            # Loglevel for a specific subsystem.
            # <subsystem> = <default>

            # If this option is enabled log entries are appended to the existing
            # file.
            # append = yes

            # Default loglevel.
            # default = 1

            # Enabling this option disables block buffering and enables line
            # buffering.
            # flush_line = no

            # Prefix each log entry with the connection name and a unique
            # numerical identifier for each IKE_SA.
            # ike_name = no

            # Prefix each log entry with a timestamp. The option accepts a
            # format string as passed to strftime(3).
            # time_format =

        # }
    }
    <% end -%>

    # Section to define syslog loggers, see LOGGER CONFIGURATION in
    # strongswan.conf(5).
    <%- if @syslog -%>
    syslog {

        <%- if @identifier -%>
        # Identifier for use with openlog(3).
        identifier = <%= @identifier %>
        <% end -%>

        <%- if @syslog_facility-%>
        # <facility> is one of the supported syslog facilities, see LOGGER
        # CONFIGURATION in strongswan.conf(5).
        <%- @syslog_facility-%> {

            <% if @global_log_level_default %>
            default = <% @global_log_level_default %>
            <% end %>

            <% if @strongswan_subsystem %>
            # Loglevel for a specific subsystem.
            # <subsystem> = <default>
             <% @strongswan_subsystem %> {

                # Default loglevel.
                default = 0
                ike = -1
                knl = 0
                cfg = 0
                mgr = 0


            # Prefix each log entry with the connection name and a unique
            # numerical identifier for each IKE_SA.
            <% end %>

            <% if @ike_name %>
            ike_name = <% @ike_name %>
            <% end %>
           }
           <% end %>

        }
        <% end -%>
    }
    <% end -%>

}